<!DOCTYPE html>
<!------------------------------------------------------------------------------
|                                                                              |
|                  DEMONSTRATION OF NEWTON'S 1ST AND 2ND LAWS                  |
|                                                                              |
|                             Author: Jonathan Mok                             |
|                          Last modified: 27 Aug 2020                          |
|                                                                              |
|          This web app is a supplementary material to a video lecture         |
|                    "2-3 Newton’s Laws of Motion (Part 1)"                    |
|                             which can be found in                            |
|            https://goodstuffhappyshare.wordpress.com/physics_eng/            |
|                                                                              |
|                          This work is licensed under                         |
|     a Creative Commons Attribution-ShareAlike 4.0 International License.     |
|                http://creativecommons.org/licenses/by-sa/4.0/                |
|                                                                              |
------------------------------------------------------------------------------->
<html>
	<head>
		<meta charset="UTF-8">
		<title>示範：牛頓第一及第二定律</title>
		<style type="text/CSS">
			/*************************** CSS STARTS ***************************/
			
			/***** Global Properties *****/
			
			*{
				font-family: "SimHei", "Microsoft JhengHei", "STHeiti",
				             "Noto Sans", sans-serif;
				font-size: 12pt;
			}
			body{
				padding: 0px;
				background-color: #000000;
			}
			div{
				position: absolute;
				left: 0px;
				top: 0px;
				margin: 0px;
				padding: 0px;
				border: 0px;
				overflow: hidden;
			}
			
			/***** Main Frame *****/
			
			#main_frame{
				height: 100%;
			}
			@media (orientation: landscape) {
				#main_frame{
					left: 50%;
					width: 720px;
					transform: translate(-50%, 0);
				}
			}
			@media (orientation: portrait) {
				#main_frame{
					width: 100%;
				}
			}
			
			/***** Layout inside Main Frame *****/
			
			#ctrl_area{
				background-color: #CCCCCC;
				overflow: auto;
			}
			
			#disp_area{
				background-color: #548234;
				overflow: auto;
			}
			
			#split_bar{
				background-color: #000000;
			}
			
			#split_bar_decor{
				background-color: #FFFFFF;
				opacity: 0.5;
			}
			
			/***** Control Area *****/
			
			#ctrl_instr{
				
			}
			
			#f_box{
				border: 1px #000000 solid;
				background-color: #FFFFFF;
			}
			
			#f_btn{
				width: 20px;
				height: 20px;
				border: 1px #000000 solid;
				background-color: #CCCCCC;
			}
			
			/***** Display Area *****/
			
			#p_box{
				border: 2px #A6CC8C solid;
				overflow: hidden;
			}
			
			/***** (From "SVG for jQuery" Plugin) *****/
			
			svg\:svg {
				display: none;
			}
			.svg_error {
				color: red;
				font-weight: bold;
			}
			
			/**************************** CSS ENDS ****************************/
		</style>
		<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
		<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
		<script type="text/javascript">
			// jQuery UI Touch Punch by furf (2014)
			// Source: https://github.com/furf/jquery-ui-touch-punch
			!function(a){function f(a,b){if(!(a.originalEvent.touches.length>1)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var e,b=a.ui.mouse.prototype,c=b._mouseInit,d=b._mouseDestroy;b._touchStart=function(a){var b=this;!e&&b._mouseCapture(a.originalEvent.changedTouches[0])&&(e=!0,b._touchMoved=!1,f(a,"mouseover"),f(a,"mousemove"),f(a,"mousedown"))},b._touchMove=function(a){e&&(this._touchMoved=!0,f(a,"mousemove"))},b._touchEnd=function(a){e&&(f(a,"mouseup"),f(a,"mouseout"),this._touchMoved||f(a,"click"),e=!1)},b._mouseInit=function(){var b=this;b.element.bind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),c.call(b)},b._mouseDestroy=function(){var b=this;b.element.unbind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),d.call(b)}}}(jQuery);
			// SVG for jQuery v1.5.0 by Keith Wood (2014)
			// Source: http://keith-wood.name/svg.html
			// License: http://keith-wood.name/licence.html
			(function($){function SVGManager(){this._settings=[];this._extensions=[];this.regional=[];this.regional['']={errorLoadingText:'Error loading'};this.local=this.regional[''];this._uuid=new Date().getTime();this._ie=!!window.ActiveXObject}$.extend(SVGManager.prototype,{markerClassName:'hasSVG',propertyName:'svgwrapper',svgNS:'http://www.w3.org/2000/svg',xlinkNS:'http://www.w3.org/1999/xlink',_wrapperClass:SVGWrapper,_attrNames:{class_:'class',in_:'in',alignmentBaseline:'alignment-baseline',baselineShift:'baseline-shift',clipPath:'clip-path',clipRule:'clip-rule',colorInterpolation:'color-interpolation',colorInterpolationFilters:'color-interpolation-filters',colorRendering:'color-rendering',dominantBaseline:'dominant-baseline',enableBackground:'enable-background',fillOpacity:'fill-opacity',fillRule:'fill-rule',floodColor:'flood-color',floodOpacity:'flood-opacity',fontFamily:'font-family',fontSize:'font-size',fontSizeAdjust:'font-size-adjust',fontStretch:'font-stretch',fontStyle:'font-style',fontVariant:'font-variant',fontWeight:'font-weight',glyphOrientationHorizontal:'glyph-orientation-horizontal',glyphOrientationVertical:'glyph-orientation-vertical',horizAdvX:'horiz-adv-x',horizOriginX:'horiz-origin-x',imageRendering:'image-rendering',letterSpacing:'letter-spacing',lightingColor:'lighting-color',markerEnd:'marker-end',markerMid:'marker-mid',markerStart:'marker-start',stopColor:'stop-color',stopOpacity:'stop-opacity',strikethroughPosition:'strikethrough-position',strikethroughThickness:'strikethrough-thickness',strokeDashArray:'stroke-dasharray',strokeDashOffset:'stroke-dashoffset',strokeLineCap:'stroke-linecap',strokeLineJoin:'stroke-linejoin',strokeMiterLimit:'stroke-miterlimit',strokeOpacity:'stroke-opacity',strokeWidth:'stroke-width',textAnchor:'text-anchor',textDecoration:'text-decoration',textRendering:'text-rendering',underlinePosition:'underline-position',underlineThickness:'underline-thickness',vertAdvY:'vert-adv-y',vertOriginY:'vert-origin-y',wordSpacing:'word-spacing',writingMode:'writing-mode'},_attachSVG:function(a,b){var c=(a.namespaceURI===this.svgNS?a:null);var a=(c?null:a);if($(a||c).hasClass(this.markerClassName)){return}if(typeof b==='string'){b={loadURL:b}}else if(typeof b==='function'){b={onLoad:b}}$(a||c).addClass(this.markerClassName);try{if(!c){c=document.createElementNS(this.svgNS,'svg');c.setAttribute('version','1.1');if(a.clientWidth>0){c.setAttribute('width',a.clientWidth)}if(a.clientHeight>0){c.setAttribute('height',a.clientHeight)}a.appendChild(c)}this._afterLoad(a,c,b||{})}catch(e){$(a).html('<p>SVG is not supported natively on this browser</p>')}},_afterLoad:function(a,b,c){var c=c||this._settings[a.id];this._settings[a?a.id:'']=null;var d=new this._wrapperClass(b,a);$.data(a||b,$.svg.propertyName,d);try{if(c.loadURL){d.load(c.loadURL,c)}if(c.settings){d.configure(c.settings)}if(c.onLoad&&!c.loadURL){c.onLoad.apply(a||b,[d])}}catch(e){alert(e)}},_getSVG:function(a){return $(a).data(this.propertyName)},_destroySVG:function(a){a=$(a);if(!a.hasClass(this.markerClassName)){return}a.removeClass(this.markerClassName).removeData(this.propertyName);if(a[0].namespaceURI!==this.svgNS){a.empty()}},addExtension:function(a,b){this._extensions.push([a,b])},isSVGElem:function(a){return(a.nodeType===1&&a.namespaceURI===$.svg.svgNS)}});function SVGWrapper(a,b){this._svg=a;this._container=b;for(var i=0;i<$.svg._extensions.length;i++){var c=$.svg._extensions[i];this[c[0]]=new c[1](this)}}$.extend(SVGWrapper.prototype,{width:function(){return(this._container?this._container.clientWidth:this._svg.width)},height:function(){return(this._container?this._container.clientHeight:this._svg.height)},root:function(){return this._svg},configure:function(a,b,c){if(!a.nodeName){c=b;b=a;a=this._svg}if(c){for(var i=a.attributes.length-1;i>=0;i--){var d=a.attributes.item(i);if(!(d.nodeName==='onload'||d.nodeName==='version'||d.nodeName.substring(0,5)==='xmlns')){a.attributes.removeNamedItem(d.nodeName)}}}for(var e in b){a.setAttribute($.svg._attrNames[e]||e,b[e])}return this},getElementById:function(a){return this._svg.ownerDocument.getElementById(a)},change:function(a,b){if(a){for(var c in b){if(b[c]==null){a.removeAttribute($.svg._attrNames[c]||c)}else{a.setAttribute($.svg._attrNames[c]||c,b[c])}}}return this},_args:function(b,c,d){c.splice(0,0,'parent');c.splice(c.length,0,'settings');var e={};var f=0;if(b[0]!=null&&b[0].jquery){b[0]=b[0][0]}if(b[0]!=null&&!(typeof b[0]==='object'&&b[0].nodeName)){e['parent']=null;f=1}for(var i=0;i<b.length;i++){e[c[i+f]]=b[i]}if(d){$.each(d,function(i,a){if(typeof e[a]==='object'){e.settings=e[a];e[a]=null}})}return e},title:function(a,b,c){var d=this._args(arguments,['text']);var e=this._makeNode(d.parent,'title',d.settings||{});e.appendChild(this._svg.ownerDocument.createTextNode(d.text));return e},describe:function(a,b,c){var d=this._args(arguments,['text']);var e=this._makeNode(d.parent,'desc',d.settings||{});e.appendChild(this._svg.ownerDocument.createTextNode(d.text));return e},defs:function(a,b,c){var d=this._args(arguments,['id'],['id']);return this._makeNode(d.parent,'defs',$.extend((d.id?{id:d.id}:{}),d.settings||{}))},symbol:function(a,b,c,d,e,f,g){var h=this._args(arguments,['id','x1','y1','width','height']);return this._makeNode(h.parent,'symbol',$.extend({id:h.id,viewBox:h.x1+' '+h.y1+' '+h.width+' '+h.height},h.settings||{}))},marker:function(a,b,c,d,e,f,g,h){var i=this._args(arguments,['id','refX','refY','mWidth','mHeight','orient'],['orient']);return this._makeNode(i.parent,'marker',$.extend({id:i.id,refX:i.refX,refY:i.refY,markerWidth:i.mWidth,markerHeight:i.mHeight,orient:i.orient||'auto'},i.settings||{}))},style:function(a,b,c){var d=this._args(arguments,['styles']);var e=this._makeNode(d.parent,'style',$.extend({type:'text/css'},d.settings||{}));e.appendChild(this._svg.ownerDocument.createTextNode(d.styles));return e},script:function(a,b,c,d){var e=this._args(arguments,['script','type'],['type']);var f=this._makeNode(e.parent,'script',$.extend({type:e.type||'text/javascript'},e.settings||{}));f.appendChild(this._svg.ownerDocument.createTextNode(e.script));if($.svg._ie){$.globalEval(e.script)}return f},linearGradient:function(a,b,c,d,e,f,g,h){var i=this._args(arguments,['id','stops','x1','y1','x2','y2'],['x1']);var j=$.extend({id:i.id},(i.x1!=null?{x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2}:{}));return this._gradient(i.parent,'linearGradient',$.extend(j,i.settings||{}),i.stops)},radialGradient:function(a,b,c,d,e,r,f,g,h){var i=this._args(arguments,['id','stops','cx','cy','r','fx','fy'],['cx']);var j=$.extend({id:i.id},(i.cx!=null?{cx:i.cx,cy:i.cy,r:i.r,fx:i.fx,fy:i.fy}:{}));return this._gradient(i.parent,'radialGradient',$.extend(j,i.settings||{}),i.stops)},_gradient:function(a,b,c,d){var e=this._makeNode(a,b,c);for(var i=0;i<d.length;i++){var f=d[i];this._makeNode(e,'stop',$.extend({offset:f[0],stopColor:f[1]},(f[2]!=null?{stopOpacity:f[2]}:{})))}return e},pattern:function(a,b,x,y,c,d,e,f,g,h,i){var j=this._args(arguments,['id','x','y','width','height','vx','vy','vwidth','vheight'],['vx']);var k=$.extend({id:j.id,x:j.x,y:j.y,width:j.width,height:j.height},(j.vx!=null?{viewBox:j.vx+' '+j.vy+' '+j.vwidth+' '+j.vheight}:{}));return this._makeNode(j.parent,'pattern',$.extend(k,j.settings||{}))},clipPath:function(a,b,c,d){var e=this._args(arguments,['id','units']);e.units=e.units||'userSpaceOnUse';return this._makeNode(e.parent,'clipPath',$.extend({id:e.id,clipPathUnits:e.units},e.settings||{}))},mask:function(a,b,x,y,c,d,e){var f=this._args(arguments,['id','x','y','width','height']);return this._makeNode(f.parent,'mask',$.extend({id:f.id,x:f.x,y:f.y,width:f.width,height:f.height},f.settings||{}))},createPath:function(){return new SVGPath()},createText:function(){return new SVGText()},svg:function(a,x,y,b,c,d,e,f,g,h){var i=this._args(arguments,['x','y','width','height','vx','vy','vwidth','vheight'],['vx']);var j=$.extend({x:i.x,y:i.y,width:i.width,height:i.height},(i.vx!=null?{viewBox:i.vx+' '+i.vy+' '+i.vwidth+' '+i.vheight}:{}));return this._makeNode(i.parent,'svg',$.extend(j,i.settings||{}))},group:function(a,b,c){var d=this._args(arguments,['id'],['id']);return this._makeNode(d.parent,'g',$.extend({id:d.id},d.settings||{}))},use:function(a,x,y,b,c,d,e){var f=this._args(arguments,['x','y','width','height','ref']);if(typeof f.x==='string'){f.ref=f.x;f.settings=f.y;f.x=f.y=f.width=f.height=null}var g=this._makeNode(f.parent,'use',$.extend({x:f.x,y:f.y,width:f.width,height:f.height},f.settings||{}));g.setAttributeNS($.svg.xlinkNS,'href',f.ref);return g},link:function(a,b,c){var d=this._args(arguments,['ref']);var e=this._makeNode(d.parent,'a',d.settings);e.setAttributeNS($.svg.xlinkNS,'href',d.ref);return e},image:function(a,x,y,b,c,d,e){var f=this._args(arguments,['x','y','width','height','ref']);var g=this._makeNode(f.parent,'image',$.extend({x:f.x,y:f.y,width:f.width,height:f.height},f.settings||{}));g.setAttributeNS($.svg.xlinkNS,'href',f.ref);return g},path:function(a,b,c){var d=this._args(arguments,['path']);return this._makeNode(d.parent,'path',$.extend({d:(d.path.path?d.path.path():d.path)},d.settings||{}))},rect:function(a,x,y,b,c,d,e,f){var g=this._args(arguments,['x','y','width','height','rx','ry'],['rx']);return this._makeNode(g.parent,'rect',$.extend({x:g.x,y:g.y,width:g.width,height:g.height},(g.rx?{rx:g.rx,ry:g.ry}:{}),g.settings||{}))},circle:function(a,b,c,r,d){var e=this._args(arguments,['cx','cy','r']);return this._makeNode(e.parent,'circle',$.extend({cx:e.cx,cy:e.cy,r:e.r},e.settings||{}))},ellipse:function(a,b,c,d,e,f){var g=this._args(arguments,['cx','cy','rx','ry']);return this._makeNode(g.parent,'ellipse',$.extend({cx:g.cx,cy:g.cy,rx:g.rx,ry:g.ry},g.settings||{}))},line:function(a,b,c,d,e,f){var g=this._args(arguments,['x1','y1','x2','y2']);return this._makeNode(g.parent,'line',$.extend({x1:g.x1,y1:g.y1,x2:g.x2,y2:g.y2},g.settings||{}))},polyline:function(a,b,c){var d=this._args(arguments,['points']);return this._poly(d.parent,'polyline',d.points,d.settings)},polygon:function(a,b,c){var d=this._args(arguments,['points']);return this._poly(d.parent,'polygon',d.points,d.settings)},_poly:function(a,b,c,d){var e='';for(var i=0;i<c.length;i++){e+=c[i].join()+' '}return this._makeNode(a,b,$.extend({points:$.trim(e)},d||{}))},text:function(a,x,y,b,c){var d=this._args(arguments,['x','y','value']);if(typeof d.x==='string'&&arguments.length<4){d.value=d.x;d.settings=d.y;d.x=d.y=null}return this._text(d.parent,'text',d.value,$.extend({x:(d.x&&$.isArray(d.x)?d.x.join(' '):d.x),y:(d.y&&$.isArray(d.y)?d.y.join(' '):d.y)},d.settings||{}))},textpath:function(a,b,c,d){var e=this._args(arguments,['path','value']);var f=this._text(e.parent,'textPath',e.value,e.settings||{});f.setAttributeNS($.svg.xlinkNS,'href',e.path);return f},_text:function(a,b,c,d){var e=this._makeNode(a,b,d);if(typeof c==='string'){e.appendChild(e.ownerDocument.createTextNode(c))}else{for(var i=0;i<c._parts.length;i++){var f=c._parts[i];if(f[0]==='tspan'){var g=this._makeNode(e,f[0],f[2]);g.appendChild(e.ownerDocument.createTextNode(f[1]));e.appendChild(g)}else if(f[0]==='tref'){var g=this._makeNode(e,f[0],f[2]);g.setAttributeNS($.svg.xlinkNS,'href',f[1]);e.appendChild(g)}else if(f[0]==='textpath'){var h=$.extend({},f[2]);h.href=null;var g=this._makeNode(e,f[0],h);g.setAttributeNS($.svg.xlinkNS,'href',f[2].href);g.appendChild(e.ownerDocument.createTextNode(f[1]));e.appendChild(g)}else{e.appendChild(e.ownerDocument.createTextNode(f[1]))}}}return e},other:function(a,b,c){var d=this._args(arguments,['name']);return this._makeNode(d.parent,d.name,d.settings||{})},_makeNode:function(a,b,c){a=a||this._svg;var d=this._svg.ownerDocument.createElementNS($.svg.svgNS,b);for(var b in c){var e=c[b];if(e!=null&&(typeof e!=='string'||e!=='')){d.setAttribute($.svg._attrNames[b]||b,e)}}a.appendChild(d);return d},add:function(b,c){var d=this._args((arguments.length===1?[null,b]:arguments),['node']);var f=this;d.parent=d.parent||this._svg;d.node=(d.node.jquery?d.node:$(d.node));try{d.parent.appendChild(d.node.cloneNode(true))}catch(e){d.node.each(function(){var a=f._cloneAsSVG(this);if(a){d.parent.appendChild(a)}})}return this},clone:function(b,c){var d=this;var e=this._args((arguments.length===1?[null,b]:arguments),['node']);e.parent=e.parent||this._svg;e.node=(e.node.jquery?e.node:$(e.node));var f=[];e.node.each(function(){var a=d._cloneAsSVG(this);if(a){a.id='';e.parent.appendChild(a);f.push(a)}});return f},_cloneAsSVG:function(a){var b=null;if(a.nodeType===1){b=this._svg.ownerDocument.createElementNS($.svg.svgNS,this._checkName(a.nodeName));for(var i=0;i<a.attributes.length;i++){var c=a.attributes.item(i);if(c.nodeName!=='xmlns'&&c.nodeValue){if(c.prefix==='xlink'){b.setAttributeNS($.svg.xlinkNS,c.localName||c.baseName,c.nodeValue)}else{b.setAttribute(this._checkName(c.nodeName),c.nodeValue)}}}for(var i=0;i<a.childNodes.length;i++){var d=this._cloneAsSVG(a.childNodes[i]);if(d){b.appendChild(d)}}}else if(a.nodeType===3){if($.trim(a.nodeValue)){b=this._svg.ownerDocument.createTextNode(a.nodeValue)}}else if(a.nodeType===4){if($.trim(a.nodeValue)){try{b=this._svg.ownerDocument.createCDATASection(a.nodeValue)}catch(e){b=this._svg.ownerDocument.createTextNode(a.nodeValue.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'))}}}return b},_checkName:function(a){a=(a.substring(0,1)>='A'&&a.substring(0,1)<='Z'?a.toLowerCase():a);return(a.substring(0,4)==='svg:'?a.substring(4):a)},load:function(l,m){m=(typeof m==='boolean'?{addTo:m}:(typeof m==='function'?{onLoad:m}:(typeof m==='string'?{parent:m}:(typeof m==='object'&&m.nodeName?{parent:m}:(typeof m==='object'&&m.jquery?{parent:m}:m||{})))));if(!m.parent&&!m.addTo){this.clear(false)}var n=[this._svg.getAttribute('width'),this._svg.getAttribute('height')];var o=this;var p=function(a){a=$.svg.local.errorLoadingText+': '+a;if(m.onLoad){m.onLoad.apply(o._container||o._svg,[o,a])}else{o.text(null,10,20,a)}};var q=function(a){var b=new ActiveXObject('Microsoft.XMLDOM');b.validateOnParse=false;b.resolveExternals=false;b.async=false;b.loadXML(a);if(b.parseError.errorCode!==0){p(b.parseError.reason);return null}return b};var r=function(b){if(!b){return}if(b.documentElement.nodeName!=='svg'){var c=b.getElementsByTagName('parsererror');var d=(c.length?c[0].getElementsByTagName('div'):[]);p(!c.length?'???':(d.length?d[0]:c[0]).firstChild.nodeValue);return}var f=(m.parent?$(m.parent)[0]:o._svg);var g={};for(var i=0;i<b.documentElement.attributes.length;i++){var h=b.documentElement.attributes.item(i);if(!(h.nodeName==='version'||h.nodeName.substring(0,5)==='xmlns')){g[h.nodeName]=h.nodeValue}}o.configure(f,g,!m.parent);var j=b.documentElement.childNodes;for(var i=0;i<j.length;i++){try{f.appendChild(o._svg.ownerDocument.importNode(j[i],true));if(j[i].nodeName==='script'){$.globalEval(j[i].textContent)}}catch(e){o.add(f,j[i])}}if(!m.keepRelativeLinks&&l.match('/')){var k=l.replace(/\/[^\/]*$/,'/');$('*',f).each(function(){var a=$(this).attr('xlink:href');if(a&&!a.match(/(^[a-z][-a-z0-9+.]*:.*$)|(^\/.*$)|(^#.*$)/i)){$(this).attr('xlink:href',k+a)}})}if(!m.changeSize){o.configure(f,{width:n[0],height:n[1]})}if(m.onLoad){m.onLoad.apply(o._container||o._svg,[o])}};if(l.match('<svg')){try{r(new DOMParser().parseFromString(l,'text/xml'))}catch(e){p(e)}}else{$.ajax({url:l,dataType:'xml',success:function(a){r(a)},error:function(a,b,c){p(b+(c?' '+c.message:''))}})}return this},remove:function(a){a=(a.jquery?a[0]:a);a.parentNode.removeChild(a);return this},clear:function(a){if(a){this.configure({},true)}while(this._svg.firstChild){this._svg.removeChild(this._svg.firstChild)}return this},toSVG:function(a){a=a||this._svg;return(typeof XMLSerializer==='undefined'?this._toSVG(a):new XMLSerializer().serializeToString(a))},_toSVG:function(a){var b='';if(!a){return b}if(a.nodeType===3){b=a.nodeValue}else if(a.nodeType===4){b='<![CDATA['+a.nodeValue+']]>'}else{b='<'+a.nodeName;if(a.attributes){for(var i=0;i<a.attributes.length;i++){var c=a.attributes.item(i);if(!($.trim(c.nodeValue)===''||c.nodeValue.match(/^\[object/)||c.nodeValue.match(/^function/))){b+=' '+(c.namespaceURI===$.svg.xlinkNS?'xlink:':'')+c.nodeName+'="'+c.nodeValue+'"'}}}if(a.firstChild){b+='>';var d=a.firstChild;while(d){b+=this._toSVG(d);d=d.nextSibling}b+='</'+a.nodeName+'>'}else{b+='/>'}}return b}});function SVGPath(){this._path=''}$.extend(SVGPath.prototype,{reset:function(){this._path='';return this},move:function(x,y,a){a=($.isArray(x)?y:a);return this._coords((a?'m':'M'),x,y)},line:function(x,y,a){a=($.isArray(x)?y:a);return this._coords((a?'l':'L'),x,y)},horiz:function(x,a){this._path+=(a?'h':'H')+($.isArray(x)?x.join(' '):x);return this},vert:function(y,a){this._path+=(a?'v':'V')+($.isArray(y)?y.join(' '):y);return this},curveC:function(a,b,c,d,x,y,e){e=($.isArray(a)?b:e);return this._coords((e?'c':'C'),a,b,c,d,x,y)},smoothC:function(a,b,x,y,c){c=($.isArray(a)?b:c);return this._coords((c?'s':'S'),a,b,x,y)},curveQ:function(a,b,x,y,c){c=($.isArray(a)?b:c);return this._coords((c?'q':'Q'),a,b,x,y)},smoothQ:function(x,y,a){a=($.isArray(x)?y:a);return this._coords((a?'t':'T'),x,y)},_coords:function(a,b,c,d,e,f,g){if($.isArray(b)){for(var i=0;i<b.length;i++){var h=b[i];this._path+=(i===0?a:' ')+h[0]+','+h[1]+(h.length<4?'':' '+h[2]+','+h[3]+(h.length<6?'':' '+h[4]+','+h[5]))}}else{this._path+=a+b+','+c+(d==null?'':' '+d+','+e+(f==null?'':' '+f+','+g))}return this},arc:function(a,b,c,d,e,x,y,f){f=($.isArray(a)?b:f);this._path+=(f?'a':'A');if($.isArray(a)){for(var i=0;i<a.length;i++){var g=a[i];this._path+=(i===0?'':' ')+g[0]+','+g[1]+' '+g[2]+' '+(g[3]?'1':'0')+','+(g[4]?'1':'0')+' '+g[5]+','+g[6]}}else{this._path+=a+','+b+' '+c+' '+(d?'1':'0')+','+(e?'1':'0')+' '+x+','+y}return this},close:function(){this._path+='z';return this},path:function(){return this._path}});SVGPath.prototype.moveTo=SVGPath.prototype.move;SVGPath.prototype.lineTo=SVGPath.prototype.line;SVGPath.prototype.horizTo=SVGPath.prototype.horiz;SVGPath.prototype.vertTo=SVGPath.prototype.vert;SVGPath.prototype.curveCTo=SVGPath.prototype.curveC;SVGPath.prototype.smoothCTo=SVGPath.prototype.smoothC;SVGPath.prototype.curveQTo=SVGPath.prototype.curveQ;SVGPath.prototype.smoothQTo=SVGPath.prototype.smoothQ;SVGPath.prototype.arcTo=SVGPath.prototype.arc;function SVGText(){this._parts=[]}$.extend(SVGText.prototype,{reset:function(){this._parts=[];return this},string:function(a){this._parts.push(['text',a]);return this},span:function(a,b){this._parts.push(['tspan',a,b]);return this},ref:function(a,b){this._parts.push(['tref',a,b]);return this},path:function(a,b,c){this._parts.push(['textpath',b,$.extend({href:a},c||{})]);return this}});$.fn.svg=function(a){var b=Array.prototype.slice.call(arguments,1);if(typeof a==='string'&&a==='get'){return $.svg['_'+a+'SVG'].apply($.svg,[this[0]].concat(b))}return this.each(function(){if(typeof a==='string'){$.svg['_'+a+'SVG'].apply($.svg,[this].concat(b))}else{$.svg._attachSVG(this,a||{})}})};$.svg=new SVGManager()})(jQuery);
			// SVG for jQuery: SVG DOM extension (from the same package)
			(function($){var j=/[\t\r\n]/g,rspace=/\s+/,rwhitespace="[\\x20\\t\\r\\n\\f]";function getClassNames(a){return(!$.svg.isSVGElem(a)?a.className:(a.className?a.className.baseVal:a.getAttribute('class')))||''}function setClassNames(a,b){(a.className?a.className.baseVal=b:a.setAttribute('class',b))}$.fn.addClass=function(f){return function(d){if($.isFunction(d)){return this.each(function(i){$(this).addClass(d.call(this,i,getClassNames(this)))})}var e=arguments;d=d||'';return this.each(function(){if($.svg.isSVGElem(this)){var c=this;$.each(d.split(/\s+/),function(i,a){var b=getClassNames(c);if($.inArray(a,b.split(/\s+/))===-1){setClassNames(c,b+=(b?' ':'')+a)}})}else{f.apply($(this),e)}})}}($.fn.addClass);$.fn.removeClass=function(f){return function(d){if($.isFunction(d)){return this.each(function(i){$(this).removeClass(d.call(this,i,getClassNames(this)))})}var e=arguments;d=d||'';return this.each(function(){if($.svg.isSVGElem(this)){var c=this;$.each(d.split(/\s+/),function(i,a){var b=getClassNames(c);b=$.grep(b.split(/\s+/),function(n,i){return n!==a}).join(' ');setClassNames(c,b)})}else{f.apply($(this),e)}})}}($.fn.removeClass);$.fn.toggleClass=function(h){return function(d,e){if($.isFunction(d)){return this.each(function(i){$(this).toggleClass(d.call(this,i,getClassNames(this),e),e)})}var f=arguments;var g=(typeof e==='boolean');return this.each(function(){if($.svg.isSVGElem(this)){if(typeof d==='string'){var b=$(this);$.each(d.split(/\s+/),function(i,a){if(!g){e=!b.hasClass(a)}b[(e?'add':'remove')+'Class'](a)})}else{var c=getClassNames(this);if(c){$._data(this,'__className__',c)}setClassNames(this,c||d===false?'':$._data(this,'__className__')||'')}}else{h.apply($(this),f)}})}}($.fn.toggleClass);$.fn.hasClass=function(c){return function(a){a=a||'';var b=false;this.each(function(){if($.svg.isSVGElem(this)){b=($.inArray(a,getClassNames(this).split(/\s+/))>-1)}else{b=(c.apply($(this),[a]))}return!b});return b}}($.fn.hasClass);$.fn.attr=function(h){return function(a,b,c){if(typeof a==='string'&&b===undefined){var d=h.apply(this,arguments);if(d&&d.baseVal&&d.baseVal.numberOfItems!=null){b='';d=d.baseVal;if(a==='transform'){for(var i=0;i<d.numberOfItems;i++){var e=d.getItem(i);switch(e.type){case 1:b+=' matrix('+e.matrix.a+','+e.matrix.b+','+e.matrix.c+','+e.matrix.d+','+e.matrix.e+','+e.matrix.f+')';break;case 2:b+=' translate('+e.matrix.e+','+e.matrix.f+')';break;case 3:b+=' scale('+e.matrix.a+','+e.matrix.d+')';break;case 4:b+=' rotate('+e.angle+')';break;case 5:b+=' skewX('+e.angle+')';break;case 6:b+=' skewY('+e.angle+')';break}}d=b.substring(1)}else{d=d.getItem(0).valueAsString}}return(d&&d.baseVal?d.baseVal.valueAsString:d)}var f=a;if(typeof a==='string'){f={};f[a]=b}if($.isFunction(b)){return $(this).each(function(i){$(this).attr(a,b.call(this,i,$(this).attr(a)))})}var g=arguments;return $(this).each(function(){if($.svg.isSVGElem(this)){for(var n in f){(c?this.style[n]=f[n]:this.setAttribute(n,f[n]))}}else{h.apply($(this),g)}})}}($.fn.attr);$.fn.removeAttr=function(e){return function(c){var d=arguments;return this.each(function(){if($.svg.isSVGElem(this)){var b=this;$.each(c.split(/\s+/),function(i,a){(b[a]&&b[a].baseVal?b[a].baseVal.value=null:b.removeAttribute(a))})}else{e.apply($(this),d)}})}}($.fn.removeAttr);$.extend($.cssNumber,{'stopOpacity':true,'strokeMitrelimit':true,'strokeOpacity':true});if($.cssProps){$.css=function(f){return function(a,b,c,d){var e=(b.match(/^svg.*/)?$(a).attr($.cssProps[b]||b):'');return e||f(a,b,c,d)}}($.css)}})(jQuery);
		</script>
		<script type="text/javascript">
			/************************ JAVASCRIPT STARTS ************************/
			
			///// LIBRARY //////////////////////////////////////////////////////
			
			// Define $("#object").left() and $("#object").top() for easy access
			
			$.fn.left = function(L){
				if(typeof L !== "undefined"){
					this.css("left", L + "px");
					return this;
				}else{
					return this.position().left;
				}
			};
			
			$.fn.top = function(T){
				if(typeof T !== "undefined"){
					this.css("top", T + "px");
					return this;
				}else{
					return this.position().top;
				}
			};
			
			///// LAYOUT ///////////////////////////////////////////////////////
			
			//----- Menu -----//
			
			// (to be added)
			
			//----- Main Frame -----//
			
			// Dimensions
			
			var main_frame_W, main_frame_H;
			var split_bar_Y; //position of centre of split bar
			var split_bar_thick = 10;
			var split_bar_decor_length = 50;
			var split_bar_decor_thick = 4;
			
			// Methods
			
			function read_main_frame_size(){
				main_frame_W = $("#main_frame").width();
				main_frame_H = $("#main_frame").height();
			}
			
			function read_split_bar_position(){
				split_bar_Y = $("#split_bar").top() + split_bar_thick / 2.0;
			}
			
			function resize_main_frame_components(){
				$("#ctrl_area").left(0);
				$("#ctrl_area").top(0);
				$("#ctrl_area").width(main_frame_W);
				$("#ctrl_area").height(split_bar_Y - split_bar_thick / 2.0);
				
				$("#disp_area").left(0);
				$("#disp_area").top(split_bar_Y + split_bar_thick / 2.0);
				$("#disp_area").width(main_frame_W);
				$("#disp_area").height(main_frame_H - split_bar_Y - split_bar_thick / 2.0);
				
				$("#split_bar").left(0);
				$("#split_bar").top(split_bar_Y - split_bar_thick/2);
				$("#split_bar").width(main_frame_W);
				$("#split_bar").height(split_bar_thick);
				
				$("#split_bar_decor").left( (main_frame_W - split_bar_decor_length) / 2.0 );
				$("#split_bar_decor").top( (split_bar_thick - split_bar_decor_thick) / 2.0 );
				$("#split_bar_decor").width(split_bar_decor_length);
				$("#split_bar_decor").height(split_bar_decor_thick);
			}
			
			// Events
			
			function layout_init(){
				read_main_frame_size();
				split_bar_Y = main_frame_H / 3.0;
				resize_main_frame_components();
				$("#split_bar").draggable({"axis":"y", "containment":"parent"});
				$("#split_bar").on("drag", split_bar_on_drag);
				$(window).resize(window_on_resize);
			}
			
			function split_bar_on_drag(){
				read_split_bar_position();
				resize_main_frame_components();
				main_on_layout_change(); // tell "Main" that layout is changed
			}
			
			function window_on_resize(){
				read_main_frame_size();
				resize_main_frame_components();
				main_on_layout_change(); // tell "Main" that layout is changed
			}
			
			///// MAIN VARIABLES ///////////////////////////////////////////////
			
			// Dimensions
			
			/* I call this "internal coordinates" which are independent of
			   the screen size. All kinematics calculations are performed
			   under this coordinate system.
			   In contrast, the coordinates used in the input and output UI
			   are what I call "display coordinates" which change with the
			   layout dimensions.
			   To distinguish between them, I use lower case [x y w h] for
			   "internal coordinates" and upper case [X Y W H L T] for
			   "display coordinates".                                         */
			
			f_x_min = -300;
			f_x_max = 300;
			f_y_min = -300;
			f_y_max = 300;
			
			f_x_range = f_x_max - f_x_min;
			f_y_range = f_y_max - f_y_min;
			
			p_sx_min = 0;
			p_sx_max = 400;
			p_sy_min = 0;
			p_sy_max = 400;
			
			p_sx_range = p_sx_max - p_sx_min;
			p_sy_range = p_sy_max - p_sy_min;
			
			// State variables
			
			p_sx = p_sx_max / 2;
			p_sy = p_sy_max / 2;
			p_vx = 100;
			p_vy = 0;
			f_x = 0;
			f_y = 0;
			
			///// INPUT UI /////////////////////////////////////////////////////
			
			//----- Control Area Layout -----//
			
			// Dimensions
			
			var ctrl_area_W, ctrl_area_H;
			var ctrl_area_pad = 15;
			var ctrl_instr_W, ctrl_instr_H;
			var f_box_size;
			var f_box_size_min = 150;
			
			// Methods
			
			function calc_ctrl_area_sizes(){
				ctrl_area_W = main_frame_W;
				ctrl_area_H = split_bar_Y - split_bar_thick / 2.0;
				
				ctrl_instr_W = $("#ctrl_instr").width();
				ctrl_instr_H = $("#ctrl_instr").height();
				
				avail_width = ctrl_area_W - ctrl_area_pad * 2;
				avail_height = ctrl_area_H - ctrl_area_pad * 3 - ctrl_instr_H;
				f_box_size = Math.max(avail_height, f_box_size_min);
				f_box_size = Math.min(f_box_size, avail_width);
			}
			
			function resize_ctrl_area_components(){
				$("#ctrl_instr").left( (ctrl_area_W - ctrl_instr_W) / 2.0 );
				$("#ctrl_instr").top(ctrl_area_pad);
				
				$("#f_box").left((ctrl_area_W - f_box_size) / 2.0);
				$("#f_box").top(ctrl_area_pad * 2 + ctrl_instr_H);
				$("#f_box").width(f_box_size);
				$("#f_box").height(f_box_size);
			}
			
			// Events
			
			function ctrl_area_init(){
				calc_ctrl_area_sizes();
				resize_ctrl_area_components();
			}
			
			function ctrl_area_on_layout_change(){
				calc_ctrl_area_sizes();
				resize_ctrl_area_components();
			}
			
			//----- f_box -----//
			
			// Variables
			
			f_btn_x = 0; // This is the position of the force button,
			f_btn_y = 0; // but using "internal coordinates"
			f_btn_is_dragging = false;
			
			// Methods (conversion between coordinates)
			
			function x_to_f_box(x){
				return 1.0 * (x - f_x_min) / f_x_range * f_box_size;
			}
			function y_to_f_box(y){
				return 1.0 * (y - f_y_min) / f_y_range * f_box_size;
			}
			function x_from_f_box(X){
				return 1.0 * X / f_box_size * f_x_range + f_x_min;
			}
			function y_from_f_box(Y){
				return 1.0 * Y / f_box_size * f_y_range + f_y_min;
			}
			
			// Methods (button object)
			
			function set_f_btn_position(){
				f_btn_left = x_to_f_box(f_btn_x) - $("#f_btn").width() / 2.0;
				f_btn_top  = y_to_f_box(f_btn_y) - $("#f_btn").height() / 2.0;
				$("#f_btn").left(f_btn_left);
				$("#f_btn").top(f_btn_top);
			}
			
			function read_f_btn_position(){
				f_btn_X = $("#f_btn").left() + $("#f_btn").width() / 2.0;
				f_btn_Y = $("#f_btn").top() + $("#f_btn").height() / 2.0;
				f_btn_x = x_from_f_box(f_btn_X);
				f_btn_y = y_from_f_box(f_btn_Y);
			}
			
			// Methods (line showing applied force)
			
			function create_force_line(){
				svg = $("#f_box").svg("get");
				svg.line(
					0,0,0,0, {id: "f_line",
					fill: 'none', stroke: 'red', strokeWidth: 3});
				redraw_force_line();
				resize_f_box_svg();
			}
			
			function redraw_force_line(){
				$("#f_line").attr({
					x1: f_box_size/2,
					y1: f_box_size/2,
					x2: x_to_f_box(f_btn_x),
					y2: y_to_f_box(f_btn_y)
				});
			}
			
			function resize_f_box_svg(){
				svg = $("#f_box").svg("get");
				svg.configure({"width": f_box_size, "height": f_box_size});
			}
			
			// Events
			
			function f_box_init(){
				set_f_btn_position();
				$("#f_btn").draggable({"containment":"parent"});
				$("#f_btn").on("dragstart", f_btn_on_dragstart);
				$("#f_btn").on("dragstop", f_btn_on_dragstop);
				
				$("#f_box").svg(function(svg){
					create_force_line();
				});
			}
			
			function f_box_on_enter_frame(dt){
				redraw_force_line();
				
				if(f_btn_is_dragging){
					read_f_btn_position();
					f_x = f_btn_x;
					f_y = f_btn_y;
				}else{
					f_btn_x *= Math.exp(-10 * dt);
					f_btn_y *= Math.exp(-10 * dt);
					set_f_btn_position();
					f_x = 0;
					f_y = 0;
				}
			}
			
			function f_box_on_layout_change(){
				resize_f_box_svg();
			}
			
			function f_btn_on_dragstart(){
				f_btn_is_dragging = true;
			}
			
			function f_btn_on_dragstop(){
				f_btn_is_dragging = false;
			}
			
			//----- Input UI Events -----//
			
			function input_UI_init(){
				ctrl_area_init();
				f_box_init();
			}
			
			function input_UI_on_enter_frame(dt){
				f_box_on_enter_frame(dt);
			}
			
			function input_UI_on_layout_change(){
				ctrl_area_on_layout_change();
				f_box_on_layout_change();
			}
			
			///// MAIN ALGORITHM ///////////////////////////////////////////////
			
			function main_algorithm_on_enter_frame(dt){
				// move
				p_sx += p_vx * dt;
				p_sy += p_vy * dt;
				p_vx += f_x * dt;
				p_vy += f_y * dt;
				
				// periodic boundary
				while( p_sx > p_sx_max ) { p_sx -= p_sx_range; }
				while( p_sx < p_sx_min ) { p_sx += p_sx_range; }
				while( p_sy > p_sy_max ) { p_sy -= p_sy_range; }
				while( p_sy < p_sy_min ) { p_sy += p_sy_range; }
			}
			
			///// OUTPUT DISPLAY ///////////////////////////////////////////////
			
			//----- Display Area -----//
			
			// Dimensions
			
			var disp_area_w, disp_area_h;
			var disp_area_pad = 15;
			var p_box_size;
			var p_box_size_min = 300;
			
			// Methods
			
			function calc_disp_area_sizes(){
				disp_area_w = main_frame_W;
				disp_area_h = main_frame_H - split_bar_Y - split_bar_thick / 2.0;
				avail_width = disp_area_w - disp_area_pad * 2;
				avail_height = disp_area_h - disp_area_pad * 2;
				p_box_size = Math.max(avail_height, p_box_size_min);
				p_box_size = Math.min(p_box_size, avail_width);
			}
			
			function resize_disp_area_components(){
				$("#p_box").left((disp_area_w - p_box_size) / 2.0);
				$("#p_box").top(disp_area_pad);
				$("#p_box").width(p_box_size);
				$("#p_box").height(p_box_size);
			}
			
			// Events
			
			function disp_area_init(){
				calc_disp_area_sizes();
				resize_disp_area_components();
			}
			
			function disp_area_on_layout_change(){
				calc_disp_area_sizes();
				resize_disp_area_components();
			}
			
			//----- p_box -----//
			
			// Variables
			
			p_size = 20; // radius of the particle in "internal coordinates"
			v_scale = 0.3; // scale factor for velocity arrow
			f_scale = 0.3; // scale factor for force arrow
			
			// Methods (conversion between coordinates)
			
			function x_to_p_box(x){
				return 1.0 * (x - p_sx_min) / p_sx_range * p_box_size;
			}
			function y_to_p_box(y){
				return 1.0 * (y - p_sy_min) / p_sy_range * p_box_size;
			}
			function length_to_p_box(len){
				return 1.0 * len / p_sx_range * p_box_size;
			}
			
			// Methods (one particle)
			
			/* There is only one particle in the box, but I make 8 idential
			   copies (N, E, S, W, NE, SE, NW, SW) of it. For example, if the			   
			   particle is approaching the east side of the p_box and part of
			   it leaves the box, the copy on the west will partly show up on
			   the other side of the box. "id" is for identifying the particle
			   and its copies, while "offset_X" and "offset_Y" are for
			   adjusting the positions of them.                               */
			
			function create_particle(id, offset_X, offset_Y){
				
				// A group containing a circle and two arrows
				
				svg = $("#p_box").svg("get");
				p_container = svg.group("p_container_" + id);
				
				// Circle
				
				svg.circle(
					p_container, 0, 0, 1, {id: "particle_" + id,
					fill: "none", stroke: "white", strokeWidth: 2});
				
				// Velocity arrow: a group containing 3 lines
				
				v_arrow = svg.group(p_container, "v_arrow_" + id);
				svg.line(
					v_arrow, 0, 0, 0, 0, {id: "v_arrow_body_" + id,
					fill: "none", stroke: "#FFE57F", strokeWidth: 2});
				svg.line(
					v_arrow, 0, 0, 0, 0, {id: "v_arrow_head1_" + id,
					fill: "none", stroke: "#FFE57F", strokeWidth: 2});
				svg.line(
					v_arrow, 0, 0, 0, 0, {id: "v_arrow_head2_" + id,
					fill: "none", stroke: "#FFE57F", strokeWidth: 2});
				
				// Force arrow: a group containing 3 lines
				
				f_arrow = svg.group(p_container, "f_arrow_" + id);
				svg.line(
					f_arrow, 0, 0, 0, 0, {id: "f_arrow_body_" + id,
					fill: "none", stroke: "red", strokeWidth: 2});
				svg.line(
					f_arrow, 0, 0, 0, 0, {id: "f_arrow_head1_" + id,
					fill: "none", stroke: "red", strokeWidth: 2});
				svg.line(
					f_arrow, 0, 0, 0, 0, {id: "f_arrow_head2_" + id,
					fill: "none", stroke: "red", strokeWidth: 2});
				
				// Draw the initial shapes
				
				redraw_particle(id, offset_X, offset_Y);
			}
			
			function redraw_particle(id, offset_X, offset_Y){
				
				// Position of particle
				
				X = x_to_p_box(p_sx) + offset_X;
				Y = y_to_p_box(p_sy) + offset_Y;
				$("#p_container_" + id).attr(
					"transform", "translate(" + X + " " + Y + ")");
				
				// Size of particle
				
				radius = length_to_p_box(p_size);
				$("#particle_" + id).attr("r", radius);
				
				// Velocity arrow
				
				v = Math.sqrt(p_vx*p_vx + p_vy*p_vy);
				v_len = length_to_p_box(v) * v_scale;
				v_angle = Math.atan2(p_vy, p_vx) * 180 / Math.PI;
				$("#v_arrow_body_" + id).attr({
					x1: 0,     y1: 0,
					x2: v_len, y2: 0
				});
				$("#v_arrow_head1_" + id).attr({
					x1: v_len,     y1: 0,
					x2: v_len - 5, y2: -5
				});
				$("#v_arrow_head2_" + id).attr({
					x1: v_len,     y1: 0,
					x2: v_len - 5, y2: 5
				});
				$("#v_arrow_" + id).attr({
					transform: "rotate(" + v_angle + ")"
				});
				
				// Force arrow
				
				f = Math.sqrt(f_x*f_x + f_y*f_y);
				f_len = length_to_p_box(f) * f_scale;
				f_angle = Math.atan2(f_y, f_x) * 180 / Math.PI;
				$("#f_arrow_body_" + id).attr({
					x1: 0,     y1: 0,
					x2: f_len, y2: 0
				});
				$("#f_arrow_head1_" + id).attr({
					x1: f_len,     y1: 0,
					x2: f_len - 5, y2: -5
				});
				$("#f_arrow_head2_" + id).attr({
					x1: f_len,     y1: 0,
					x2: f_len - 5, y2: 5
				});
				$("#f_arrow_" + id).attr({
					transform: "rotate(" + f_angle + ")"
				});
				if(f_btn_is_dragging){
					$("#f_arrow_" + id).attr("opacity", 1);
				}else{
					$("#f_arrow_" + id).attr("opacity", 0);
				}
			}
			
			// Methods (all particles)
			
			function create_particles(){
				for(i=-1; i<=1; i++){
					for(j=-1; j<=1; j++){
						id = "" + (i+2) + (j+2);
						create_particle(id, i*p_box_size, j*p_box_size);
					}
				}
			}
			
			function redraw_particles(){
				for(i=-1; i<=1; i++){
					for(j=-1; j<=1; j++){
						id = "" + (i+2) + (j+2);
						redraw_particle(id, i*p_box_size, j*p_box_size);
					}
				}
			}
			
			// Methods (others)
			
			function resize_p_box_svg(){
				svg = $("#p_box").svg("get");
				svg.configure({"width": p_box_size, "height": p_box_size});
			}
			
			// Events
			
			function p_box_init(){
				$("#p_box").svg(function(svg){
					create_particles();
					resize_p_box_svg();
				});
			}
			
			function p_box_on_enter_frame(dt){
				redraw_particles();
			}
			
			function p_box_on_layout_change(){
				redraw_particles();
				resize_p_box_svg();
			}
			
			//----- Output Display Events -----//
			
			function output_display_init(){
				disp_area_init();
				p_box_init();
			}
			
			function output_display_on_enter_frame(dt){
				p_box_on_enter_frame(dt);
			}
			
			function output_display_on_layout_change(){
				disp_area_on_layout_change();
				p_box_on_layout_change();
			}
			
			///// MAIN LOOP ////////////////////////////////////////////////////
			
			//----- Event Triggers -----//
			
			function main_on_load(){
				// call these functions when document is loaded
				layout_init();
				input_UI_init();
				output_display_init();
			}
			
			function main_on_enter_frame(dt){
				// call these functions in every new frame
				// dt = time passed since last frame (in seconds)
				input_UI_on_enter_frame(dt);
				main_algorithm_on_enter_frame(dt);
				output_display_on_enter_frame(dt);
			}
			
			function main_on_layout_change(){
				// call these functions when the layout is changed
				input_UI_on_layout_change();
				output_display_on_layout_change();
			}
			
			//----- Configure Main Time Loop -----//
			
			var time_prev = null;
			var time_now = null;
			
			function next_frame(timestamp){
				if(!time_now){
					time_now = timestamp;
					requestAnimationFrame(next_frame);
				}else{
					time_prev = time_now;
					time_now = timestamp;
					dt = (time_now - time_prev) / 1000.0;
					main_on_enter_frame(dt);
					requestAnimationFrame(next_frame);
				}
			}
			
			//----- Power On -----//
			
			$(document).ready(function(){
				main_on_load();
				requestAnimationFrame(next_frame);
			});
			
			/************************* JAVASCRIPT ENDS *************************/
		</script>
	</head>
	<body>
		<!---------------------------- BODY STARTS ----------------------------->
		<div id="main_frame">
			<div id="ctrl_area">
				<div id="ctrl_instr">拖曳以下按鈕，向物體施力：</div>
				<div id="f_box">
					<div id="f_btn"></div>
				</div>
			</div>
			<div id="disp_area">
				<div id="p_box"></div>
			</div>
			<div id="split_bar" class="ui-widget-content">
				<div id="split_bar_decor"></div>
			</div>
		</div>
		<!----------------------------- BODY ENDS ------------------------------>
	</body>
</html>
